        // Handle file selection
        function handleFileSelect(input) {
            const file = input.files[0];
            if (!file) return;
            
            if (!file.type.match('image.*')) {
                alert('Please select an image file (JPG, PNG, WEBP, GIF)');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    // Depending on which tool is active, show the appropriate preview
                    const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
                    
                    if (activeTab === 'converter') {
                        document.getElementById('original-image').src = e.target.result;
                        document.getElementById('converter-preview').style.display = 'flex';
                        
                        // Display image info
                        document.getElementById('original-info').innerHTML = `
                            <strong>Name:</strong> ${file.name}<br>
                            <strong>Type:</strong> ${file.type}<br>
                            <strong>Size:</strong> ${(file.size / 1024).toFixed(2)} KB<br>
                            <strong>Dimensions:</strong> ${img.width} × ${img.height} px
                        `;
                    } 
                    else if (activeTab === 'compressor') {
                        document.getElementById('original-compressed').src = e.target.result;
                        document.getElementById('compressor-preview').style.display = 'flex';
                        
                        // Display image info
                        document.getElementById('original-compressed-info').innerHTML = `
                            <strong>Name:</strong> ${file.name}<br>
                            <strong>Type:</strong> ${file.type}<br>
                            <strong>Size:</strong> ${(file.size / 1024).toFixed(2)} KB<br>
                            <strong>Dimensions:</strong> ${img.width} × ${img.height} px
                        `;
                    }
                    else if (activeTab === 'watermark') {
                        document.getElementById('original-watermarked').src = e.target.result;
                        document.getElementById('watermark-preview').style.display = 'flex';
                    }
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // Quality slider value display
        document.getElementById('quality').addEventListener('input', function() {
            document.getElementById('quality-value').textContent = this.value;
        });

        document.getElementById('custom-quality').addEventListener('input', function() {
            document.getElementById('custom-quality-value').textContent = this.value;
        });

        // Compression level selection
        document.getElementById('compression-level').addEventListener('change', function() {
            const customGroup = document.getElementById('custom-quality-group');
            customGroup.style.display = this.value === 'custom' ? 'block' : 'none';
        });

        // Watermark type selection
        document.getElementById('watermark-type').addEventListener('change', function() {
            const textGroup = document.getElementById('text-watermark-group');
            const imageGroup = document.getElementById('image-watermark-group');
            
            if (this.value === 'text') {
                textGroup.style.display = 'block';
                imageGroup.style.display = 'none';
            } else {
                textGroup.style.display = 'none';
                imageGroup.style.display = 'block';
            }
        });

        // Watermark opacity slider
        document.getElementById('watermark-opacity').addEventListener('input', function() {
            document.getElementById('opacity-value').textContent = this.value;
        });

        // Convert button click handler (simulated)
        document.getElementById('convert-btn').addEventListener('click', function() {
            const originalImg = document.getElementById('original-image');
            if (!originalImg.src) {
                alert('Please upload an image first');
                return;
            }
            
            // Simulate conversion (in a real app, this would use canvas API)
            document.getElementById('converted-image').src = originalImg.src;
            
            // Simulate file info changes
            const originalSize = document.querySelector('#original-info strong:nth-child(3)').nextSibling.textContent.trim();
            const newSize = (parseFloat(originalSize) * (document.getElementById('quality').value / 100)).toFixed(2);
            
            document.getElementById('converted-info').innerHTML = `
                <strong>Format:</strong> ${document.getElementById('output-format').value.toUpperCase()}<br>
                <strong>Quality:</strong> ${document.getElementById('quality').value}%<br>
                <strong>Size:</strong> ${newSize} KB<br>
                <strong>Dimensions:</strong> ${originalImg.naturalWidth} × ${originalImg.naturalHeight} px
            `;
            
            // Simulate download button
            document.getElementById('download-converted').addEventListener('click', function(e) {
                e.preventDefault();
                alert('In a real application, this would download the converted image');
            });
        });

        // Compress button click handler (simulated)
        document.getElementById('compress-btn').addEventListener('click', function() {
            const originalImg = document.getElementById('original-compressed');
            if (!originalImg.src) {
                alert('Please upload an image first');
                return;
            }
            
            // Simulate compression (in a real app, this would use canvas API)
            document.getElementById('compressed-image').src = originalImg.src;
            
            // Calculate simulated compressed size based on compression level
            const originalSize = parseFloat(document.querySelector('#original-compressed-info strong:nth-child(3)').nextSibling.textContent.trim());
            let compressionRatio = 0.7; // default for medium
            
            const compressionLevel = document.getElementById('compression-level').value;
            if (compressionLevel === 'low') compressionRatio = 0.9;
            else if (compressionLevel === 'high') compressionRatio = 0.5;
            else if (compressionLevel === 'custom') compressionRatio = document.getElementById('custom-quality').value / 100;
            
            const newSize = (originalSize * compressionRatio).toFixed(2);
            
            document.getElementById('compressed-info').innerHTML = `
                <strong>Compression:</strong> ${compressionLevel}<br>
                <strong>Size:</strong> ${newSize} KB (${((1 - compressionRatio) * 100).toFixed(0)}% reduction)<br>
                <strong>Dimensions:</strong> ${originalImg.naturalWidth} × ${originalImg.naturalHeight} px
            `;
            
            // Simulate download button
            document.getElementById('download-compressed').addEventListener('click', function(e) {
                e.preventDefault();
                alert('In a real application, this would download the compressed image');
            });
        });

        // Watermark button click handler (simulated)
        document.getElementById('apply-watermark-btn').addEventListener('click', function() {
            const originalImg = document.getElementById('original-watermarked');
            if (!originalImg.src) {
                alert('Please upload an image first');
                return;
            }
            
            // Simulate watermarking (in a real app, this would use canvas API)
            document.getElementById('watermarked-image').src = originalImg.src;
            
            // Simulate download button
            document.getElementById('download-watermarked').addEventListener('click', function(e) {
                e.preventDefault();
                alert('In a real application, this would download the watermarked image');
            });
        });
    </script>
</body>
</html>
